---
import Layout from './Layout.astro'
import BaseLayout from '../components/BaseLayout.astro'
import Footer from '../components/Footer.astro'
import ClientMarquee from '../components/ClientMarquee.astro'

interface Props {
  frontmatter: {
    title: string
    description: string
    published: Date
    image?: string
  }
}

const { frontmatter } = Astro.props

const dateFormatter = new Intl.DateTimeFormat('en-GB', {
  dateStyle: 'long',
})
---

<Layout
  title={frontmatter.title}
  description={frontmatter.description}
  image={frontmatter.image}
  ogType="article"
>
  <BaseLayout>
    <!-- Back link -->
    <a
      href="/blog"
      class="inline-flex items-center gap-2 text-sm text-warm-500 hover:text-warm-700 dark:hover:text-warm-300 transition-colors group"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 20 20"
        fill="currentColor"
        class="w-4 h-4 group-hover:-translate-x-1 transition-transform"
      >
        <path
          fill-rule="evenodd"
          d="M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z"
          clip-rule="evenodd"></path>
      </svg>
      Back to blog
    </a>

    <!-- Article -->
    <article class="mt-8 animate-fade-in-up opacity-0">
      <!-- Header -->
      <header class="mb-10 flex flex-col-reverse sm:flex-row gap-6 sm:gap-8">
        <div class="flex-1">
          <time
            class="text-sm font-medium text-accent-600 dark:text-accent-400"
            datetime={frontmatter.published.toISOString()}
          >
            {dateFormatter.format(frontmatter.published)}
          </time>
          <h1
            class="text-3xl sm:text-4xl font-bold text-warm-900 dark:text-white mt-2 leading-tight"
          >
            {frontmatter.title}
          </h1>
          <p
            class="text-lg text-warm-600 dark:text-warm-400 mt-3 leading-relaxed"
          >
            {frontmatter.description}
          </p>
        </div>
        {
          frontmatter.image && (
            <div class="flex-shrink-0">
              <img
                class="w-full sm:w-48 rounded-lg"
                src={frontmatter.image}
                alt={frontmatter.title}
              />
            </div>
          )
        }
      </header>

      <!-- Content -->
      <div
        class="prose prose-lg max-w-none
          prose-headings:text-warm-900 dark:prose-headings:text-white prose-headings:font-semibold
          prose-h2:text-2xl prose-h2:mt-10 prose-h2:mb-4
          prose-h3:text-xl prose-h3:mt-8 prose-h3:mb-3
          prose-p:text-warm-600 dark:prose-p:text-warm-400 prose-p:leading-relaxed
          prose-a:text-accent-600 dark:prose-a:text-accent-400 prose-a:no-underline prose-a:border-b prose-a:border-accent-300 dark:prose-a:border-accent-700 hover:prose-a:border-accent-500
          prose-strong:text-warm-900 dark:prose-strong:text-white prose-strong:font-semibold
          prose-code:text-warm-800 dark:prose-code:text-warm-200 prose-code:bg-warm-100 dark:prose-code:bg-dark-elevated prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded-md prose-code:border prose-code:border-warm-200 dark:prose-code:border-warm-800 prose-code:before:content-none prose-code:after:content-none
          prose-blockquote:border-accent-500 prose-blockquote:bg-warm-100 dark:prose-blockquote:bg-dark-elevated prose-blockquote:rounded-r-lg prose-blockquote:text-warm-600 dark:prose-blockquote:text-warm-400 prose-blockquote:not-italic
          prose-ul:text-warm-600 dark:prose-ul:text-warm-400
          prose-ol:text-warm-600 dark:prose-ol:text-warm-400
          prose-li:marker:text-accent-500
          prose-img:rounded-lg"
      >
        <slot />
      </div>
    </article>

    <!-- Bottom back link -->
    <div class="mt-12 pt-8 border-t border-warm-200 dark:border-warm-800">
      <a
        href="/blog"
        class="inline-flex items-center gap-2 text-sm font-medium text-warm-600 dark:text-warm-400 hover:text-accent-600 dark:hover:text-accent-400 transition-colors group"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 20 20"
          fill="currentColor"
          class="w-4 h-4 group-hover:-translate-x-1 transition-transform"
        >
          <path
            fill-rule="evenodd"
            d="M17 10a.75.75 0 01-.75.75H5.612l4.158 3.96a.75.75 0 11-1.04 1.08l-5.5-5.25a.75.75 0 010-1.08l5.5-5.25a.75.75 0 111.04 1.08L5.612 9.25H16.25A.75.75 0 0117 10z"
            clip-rule="evenodd"></path>
        </svg>
        Back to all posts
      </a>
    </div>

    <ClientMarquee />

    <Footer />
  </BaseLayout>
</Layout>
